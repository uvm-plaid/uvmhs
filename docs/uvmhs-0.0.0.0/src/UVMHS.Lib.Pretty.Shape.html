<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">UVMHS.Lib.Pretty.Shape</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="UVMHS.Core.html"><span class="hs-identifier">UVMHS.Core</span></a></span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Shape --</span><span>
</span><span id="line-7"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-- A shape looks like:</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-12"></span><span class="hs-comment">--     XX</span><span>
</span><span id="line-13"></span><span class="hs-comment">--     XXX</span><span>
</span><span id="line-14"></span><span class="hs-comment">--     XXXX</span><span>
</span><span id="line-15"></span><span class="hs-comment">--     XX</span><span>
</span><span id="line-16"></span><span class="hs-comment">--     XXXXXX</span><span>
</span><span id="line-17"></span><span class="hs-comment">--     XXXX</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- this example shape is abstracted as:</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- YYYYYY</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- YYYYYY</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- YYYYYY</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- YYYYYY</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- YYYYYY</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- ZZZZ</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- where:</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- + XXX:    represented by the length of the first line</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- + YYYYYY: represented by the maximum length of any line that isn't</span><span>
</span><span id="line-32"></span><span class="hs-comment">--           the first or last</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- + ZZZZ:   represented by the maximum length of the last line</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- + also:   the total number of newlines in the shape</span><span>
</span><span id="line-35"></span><span class="hs-comment">--           (i.e., one more than number of lines in YYYYYYY)</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- A special case is a single-line shape, which is represented as</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- just the length of the line.</span><span>
</span><span id="line-39"></span><span class="hs-comment">--</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- shapes can be combined and form a monoid</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">data</span><span> </span><span id="ShapeM"><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ShapeM"><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="shapeMFirstLength"><span class="annot"><span class="annottext">ShapeM -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeMFirstLength"><span class="hs-identifier hs-var hs-var">shapeMFirstLength</span></a></span></span><span>  </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="shapeMMidMaxLength"><span class="annot"><span class="annottext">ShapeM -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeMMidMaxLength"><span class="hs-identifier hs-var hs-var">shapeMMidMaxLength</span></a></span></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="shapeMLastLength"><span class="annot"><span class="annottext">ShapeM -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeMLastLength"><span class="hs-identifier hs-var hs-var">shapeMLastLength</span></a></span></span><span>   </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="shapeMNewlines"><span class="annot"><span class="annottext">ShapeM -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeMNewlines"><span class="hs-identifier hs-var hs-var">shapeMNewlines</span></a></span></span><span>     </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680754382"><span id="local-6989586621680754388"><span class="annot"><span class="annottext">ShapeM -&gt; ShapeM -&gt; Bool
(ShapeM -&gt; ShapeM -&gt; Bool)
-&gt; (ShapeM -&gt; ShapeM -&gt; Bool) -&gt; Eq ShapeM
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ShapeM -&gt; ShapeM -&gt; Bool
== :: ShapeM -&gt; ShapeM -&gt; Bool
$c/= :: ShapeM -&gt; ShapeM -&gt; Bool
/= :: ShapeM -&gt; ShapeM -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680754395"><span id="local-6989586621680754402"><span id="local-6989586621680754408"><span id="local-6989586621680754412"><span id="local-6989586621680754415"><span id="local-6989586621680754418"><span id="local-6989586621680754421"><span class="annot"><span class="annottext">Eq ShapeM
Eq ShapeM =&gt;
(ShapeM -&gt; ShapeM -&gt; Ordering)
-&gt; (ShapeM -&gt; ShapeM -&gt; Bool)
-&gt; (ShapeM -&gt; ShapeM -&gt; Bool)
-&gt; (ShapeM -&gt; ShapeM -&gt; Bool)
-&gt; (ShapeM -&gt; ShapeM -&gt; Bool)
-&gt; (ShapeM -&gt; ShapeM -&gt; ShapeM)
-&gt; (ShapeM -&gt; ShapeM -&gt; ShapeM)
-&gt; Ord ShapeM
ShapeM -&gt; ShapeM -&gt; Bool
ShapeM -&gt; ShapeM -&gt; Ordering
ShapeM -&gt; ShapeM -&gt; ShapeM
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: ShapeM -&gt; ShapeM -&gt; Ordering
compare :: ShapeM -&gt; ShapeM -&gt; Ordering
$c&lt; :: ShapeM -&gt; ShapeM -&gt; Bool
&lt; :: ShapeM -&gt; ShapeM -&gt; Bool
$c&lt;= :: ShapeM -&gt; ShapeM -&gt; Bool
&lt;= :: ShapeM -&gt; ShapeM -&gt; Bool
$c&gt; :: ShapeM -&gt; ShapeM -&gt; Bool
&gt; :: ShapeM -&gt; ShapeM -&gt; Bool
$c&gt;= :: ShapeM -&gt; ShapeM -&gt; Bool
&gt;= :: ShapeM -&gt; ShapeM -&gt; Bool
$cmax :: ShapeM -&gt; ShapeM -&gt; ShapeM
max :: ShapeM -&gt; ShapeM -&gt; ShapeM
$cmin :: ShapeM -&gt; ShapeM -&gt; ShapeM
min :: ShapeM -&gt; ShapeM -&gt; ShapeM
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680754425"><span id="local-6989586621680754434"><span id="local-6989586621680754438"><span class="annot"><span class="annottext">Int -&gt; ShapeM -&gt; ShowS
[ShapeM] -&gt; ShowS
ShapeM -&gt; String
(Int -&gt; ShapeM -&gt; ShowS)
-&gt; (ShapeM -&gt; String) -&gt; ([ShapeM] -&gt; ShowS) -&gt; Show ShapeM
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ShapeM -&gt; ShowS
showsPrec :: Int -&gt; ShapeM -&gt; ShowS
$cshow :: ShapeM -&gt; String
show :: ShapeM -&gt; String
$cshowList :: [ShapeM] -&gt; ShowS
showList :: [ShapeM] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="shapeMFirstLengthL"><span id="shapeMMidMaxLengthL"><span id="shapeMLastLengthL"><span id="shapeMNewlinesL"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ShapeM</span></span></span></span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">data</span><span> </span><span id="Shape"><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-var">Shape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>    </span><span id="SingleLine"><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-var">SingleLine</span></a></span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MultiLine"><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680754457"><span id="local-6989586621680754461"><span class="annot"><span class="annottext">Shape -&gt; Shape -&gt; Bool
(Shape -&gt; Shape -&gt; Bool) -&gt; (Shape -&gt; Shape -&gt; Bool) -&gt; Eq Shape
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Shape -&gt; Shape -&gt; Bool
== :: Shape -&gt; Shape -&gt; Bool
$c/= :: Shape -&gt; Shape -&gt; Bool
/= :: Shape -&gt; Shape -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680754467"><span id="local-6989586621680754471"><span id="local-6989586621680754475"><span id="local-6989586621680754479"><span id="local-6989586621680754482"><span id="local-6989586621680754485"><span id="local-6989586621680754488"><span class="annot"><span class="annottext">Eq Shape
Eq Shape =&gt;
(Shape -&gt; Shape -&gt; Ordering)
-&gt; (Shape -&gt; Shape -&gt; Bool)
-&gt; (Shape -&gt; Shape -&gt; Bool)
-&gt; (Shape -&gt; Shape -&gt; Bool)
-&gt; (Shape -&gt; Shape -&gt; Bool)
-&gt; (Shape -&gt; Shape -&gt; Shape)
-&gt; (Shape -&gt; Shape -&gt; Shape)
-&gt; Ord Shape
Shape -&gt; Shape -&gt; Bool
Shape -&gt; Shape -&gt; Ordering
Shape -&gt; Shape -&gt; Shape
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Shape -&gt; Shape -&gt; Ordering
compare :: Shape -&gt; Shape -&gt; Ordering
$c&lt; :: Shape -&gt; Shape -&gt; Bool
&lt; :: Shape -&gt; Shape -&gt; Bool
$c&lt;= :: Shape -&gt; Shape -&gt; Bool
&lt;= :: Shape -&gt; Shape -&gt; Bool
$c&gt; :: Shape -&gt; Shape -&gt; Bool
&gt; :: Shape -&gt; Shape -&gt; Bool
$c&gt;= :: Shape -&gt; Shape -&gt; Bool
&gt;= :: Shape -&gt; Shape -&gt; Bool
$cmax :: Shape -&gt; Shape -&gt; Shape
max :: Shape -&gt; Shape -&gt; Shape
$cmin :: Shape -&gt; Shape -&gt; Shape
min :: Shape -&gt; Shape -&gt; Shape
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680754491"><span id="local-6989586621680754497"><span id="local-6989586621680754501"><span class="annot"><span class="annottext">Int -&gt; Shape -&gt; ShowS
[Shape] -&gt; ShowS
Shape -&gt; String
(Int -&gt; Shape -&gt; ShowS)
-&gt; (Shape -&gt; String) -&gt; ([Shape] -&gt; ShowS) -&gt; Show Shape
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Shape -&gt; ShowS
showsPrec :: Int -&gt; Shape -&gt; ShowS
$cshow :: Shape -&gt; String
show :: Shape -&gt; String
$cshowList :: [Shape] -&gt; ShowS
showList :: [Shape] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span id="singleLineL"><span id="multiLineL"><span class="hs-identifier">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Shape</span></span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#shapeFirstLength"><span class="hs-identifier hs-type">shapeFirstLength</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-57"></span><span id="shapeFirstLength"><span class="annot"><span class="annottext">shapeFirstLength :: Shape -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeFirstLength"><span class="hs-identifier hs-var hs-var">shapeFirstLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754513"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754513"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754513"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span id="local-6989586621680754514"><span class="annot"><span class="annottext">ShapeM
</span><a href="#local-6989586621680754514"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeMFirstLength"><span class="hs-identifier hs-var">shapeMFirstLength</span></a></span><span> </span><span class="annot"><span class="annottext">ShapeM
</span><a href="#local-6989586621680754514"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#shapeLastLength"><span class="hs-identifier hs-type">shapeLastLength</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-62"></span><span id="shapeLastLength"><span class="annot"><span class="annottext">shapeLastLength :: Shape -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeLastLength"><span class="hs-identifier hs-var hs-var">shapeLastLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754516"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754516"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754516"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span id="local-6989586621680754517"><span class="annot"><span class="annottext">ShapeM
</span><a href="#local-6989586621680754517"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeMLastLength"><span class="hs-identifier hs-var">shapeMLastLength</span></a></span><span> </span><span class="annot"><span class="annottext">ShapeM
</span><a href="#local-6989586621680754517"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#newlineShapeM"><span class="hs-identifier hs-type">newlineShapeM</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span>
</span><span id="line-67"></span><span id="newlineShapeM"><span class="annot"><span class="annottext">newlineShapeM :: ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#newlineShapeM"><span class="hs-identifier hs-var hs-var">newlineShapeM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. Zero a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. Zero a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. Zero a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. One a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#one"><span class="hs-identifier hs-var">one</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#newlineShape"><span class="hs-identifier hs-type">newlineShape</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-70"></span><span id="newlineShape"><span class="annot"><span class="annottext">newlineShape :: Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#newlineShape"><span class="hs-identifier hs-var hs-var">newlineShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#newlineShapeM"><span class="hs-identifier hs-var">newlineShapeM</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#boxShape"><span class="hs-identifier hs-type">boxShape</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-73"></span><span id="boxShape"><span class="annot"><span class="annottext">boxShape :: &#8469;64 -&gt; &#8469;64 -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#boxShape"><span class="hs-identifier hs-var hs-var">boxShape</span></a></span></span><span> </span><span id="local-6989586621680754523"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754523"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680754524"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754524"><span class="hs-identifier hs-var">nls</span></a></span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754524"><span class="hs-identifier hs-var">nls</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="UVMHS.Core.Classes.Order.html#%2261"><span class="hs-operator hs-var">&#8801;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. Zero a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-var">SingleLine</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754523"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754523"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754523"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754523"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754524"><span class="hs-identifier hs-var">nls</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#shapeWidth"><span class="hs-identifier hs-type">shapeWidth</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-78"></span><span id="shapeWidth"><span class="annot"><span class="annottext">shapeWidth :: Shape -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeWidth"><span class="hs-identifier hs-var hs-var">shapeWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754528"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754528"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754528"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754529"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754529"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621680754530"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754530"><span class="hs-identifier hs-var">mml</span></a></span></span><span> </span><span id="local-6989586621680754531"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754531"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754529"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754530"><span class="hs-identifier hs-var">mml</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754531"><span class="hs-identifier hs-var">ll</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#shapeNewlines"><span class="hs-identifier hs-type">shapeNewlines</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%211564"><span class="hs-identifier hs-type">&#8469;64</span></a></span><span>
</span><span id="line-83"></span><span id="shapeNewlines"><span class="annot"><span class="annottext">shapeNewlines :: Shape -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeNewlines"><span class="hs-identifier hs-var hs-var">shapeNewlines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. Zero a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span id="local-6989586621680754534"><span class="annot"><span class="annottext">ShapeM
</span><a href="#local-6989586621680754534"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeMNewlines"><span class="hs-identifier hs-var">shapeMNewlines</span></a></span><span> </span><span class="annot"><span class="annottext">ShapeM
</span><a href="#local-6989586621680754534"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#Null"><span class="hs-identifier hs-type">Null</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680754539"><span class="annot"><span class="annottext">null :: Shape
</span><a href="#local-6989586621680754539"><span class="hs-identifier hs-var hs-var hs-var hs-var">null</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-var">SingleLine</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. Zero a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754553"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754553"><span class="hs-identifier hs-var">l&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754554"><span class="annot"><span class="annottext">&#10746; :: Shape -&gt; Shape -&gt; Shape
</span><a href="#local-6989586621680754554"><span class="hs-operator hs-var hs-var hs-var hs-var">&#10746;</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754556"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754556"><span class="hs-identifier hs-var">l&#8322;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- AAA &#10746; XXX = AAAXXX</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">&#8469;64 -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-var">SingleLine</span></a></span><span> </span><span class="annot"><span class="annottext">(&#8469;64 -&gt; Shape) -&gt; &#8469;64 -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754553"><span class="hs-identifier hs-var">l&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Append a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Monoid.html#%29FA"><span class="hs-operator hs-var">&#10746;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754556"><span class="hs-identifier hs-var">l&#8322;</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754557"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754557"><span class="hs-identifier hs-var">l&#8321;</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#%29FA"><span class="hs-operator hs-var">&#10746;</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754558"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754558"><span class="hs-identifier hs-var">fl&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754559"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754559"><span class="hs-identifier hs-var">mml&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754560"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754560"><span class="hs-identifier hs-var">ll&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754561"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754561"><span class="hs-identifier hs-var">nls&#8322;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- AAA  &#10746;  &#9633;&#9633;&#9633;&#9633;XXX  =  &#9633;&#9633;&#9633;&#9633;AAAXXX</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-comment">--         YY          YY</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">--         ZZZZ        ZZZZ</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754557"><span class="hs-identifier hs-var">l&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Plus a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754558"><span class="hs-identifier hs-var">fl&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754559"><span class="hs-identifier hs-var">mml&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754560"><span class="hs-identifier hs-var">ll&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754561"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754563"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754563"><span class="hs-identifier hs-var">fl&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754564"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754564"><span class="hs-identifier hs-var">mml&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754565"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754565"><span class="hs-identifier hs-var">ll&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754566"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754566"><span class="hs-identifier hs-var">nls&#8321;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#%29FA"><span class="hs-operator hs-var">&#10746;</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754567"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754567"><span class="hs-identifier hs-var">l&#8322;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- &#9633;&#9633;&#9633;&#9633;XXX  &#10746;  AAA  =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">-- YY                  YY</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- ZZZZ                ZZZZAAA</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754563"><span class="hs-identifier hs-var">fl&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754564"><span class="hs-identifier hs-var">mml&#8321;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754565"><span class="hs-identifier hs-var">ll&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Plus a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754567"><span class="hs-identifier hs-var">l&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754566"><span class="hs-identifier hs-var">nls&#8321;</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754568"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754568"><span class="hs-identifier hs-var">fl&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754569"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754569"><span class="hs-identifier hs-var">mml&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754570"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754570"><span class="hs-identifier hs-var">ll&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754571"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754571"><span class="hs-identifier hs-var">nls&#8321;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#%29FA"><span class="hs-operator hs-var">&#10746;</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754572"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754572"><span class="hs-identifier hs-var">fl&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754573"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754573"><span class="hs-identifier hs-var">mml&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754574"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754574"><span class="hs-identifier hs-var">ll&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754575"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754575"><span class="hs-identifier hs-var">nls&#8322;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- &#9633;&#9633;&#9633;&#9633;XXX  &#10746;  &#9633;&#9633;&#9633;&#9633;AAA  =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">-- YY          BB          YY</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- ZZZZ        CCCC        ZZZZAAA</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">--                         BB</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">--                         CCCC</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754568"><span class="hs-identifier hs-var">fl&#8321;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754569"><span class="hs-identifier hs-var">mml&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754570"><span class="hs-identifier hs-var">ll&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Plus a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754572"><span class="hs-identifier hs-var">fl&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754573"><span class="hs-identifier hs-var">mml&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754574"><span class="hs-identifier hs-var">ll&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">(&#8469;64 -&gt; ShapeM) -&gt; &#8469;64 -&gt; ShapeM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754571"><span class="hs-identifier hs-var">nls&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Plus a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754575"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span>
</span><span id="line-109"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Lattice.html#Bot"><span class="hs-identifier hs-type">Bot</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680754586"><span class="annot"><span class="annottext">bot :: Shape
</span><a href="#local-6989586621680754586"><span class="hs-identifier hs-var hs-var hs-var hs-var">bot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-var">SingleLine</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
forall a. Zero a =&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-112"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Lattice.html#Join"><span class="hs-identifier hs-type">Join</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754606"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754606"><span class="hs-identifier hs-var">l&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754607"><span class="annot"><span class="annottext">&#8852; :: Shape -&gt; Shape -&gt; Shape
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var hs-var hs-var hs-var">&#8852;</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754608"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754608"><span class="hs-identifier hs-var">l&#8322;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-var">SingleLine</span></a></span><span> </span><span class="annot"><span class="annottext">(&#8469;64 -&gt; Shape) -&gt; &#8469;64 -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754606"><span class="hs-identifier hs-var">l&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754608"><span class="hs-identifier hs-var">l&#8322;</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754609"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754609"><span class="hs-identifier hs-var">l&#8321;</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754610"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754610"><span class="hs-identifier hs-var">fl&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754611"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754611"><span class="hs-identifier hs-var">mml&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754612"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754612"><span class="hs-identifier hs-var">ll&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754613"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754613"><span class="hs-identifier hs-var">nls&#8322;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754609"><span class="hs-identifier hs-var">l&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754610"><span class="hs-identifier hs-var">fl&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754611"><span class="hs-identifier hs-var">mml&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754612"><span class="hs-identifier hs-var">ll&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754613"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754614"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754614"><span class="hs-identifier hs-var">fl&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754615"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754615"><span class="hs-identifier hs-var">mml&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754616"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754616"><span class="hs-identifier hs-var">ll&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754617"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754617"><span class="hs-identifier hs-var">nls&#8321;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#SingleLine"><span class="hs-identifier hs-type">SingleLine</span></a></span><span> </span><span id="local-6989586621680754618"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754618"><span class="hs-identifier hs-var">l&#8322;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754618"><span class="hs-identifier hs-var">l&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754614"><span class="hs-identifier hs-var">fl&#8321;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754615"><span class="hs-identifier hs-var">mml&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754616"><span class="hs-identifier hs-var">ll&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754617"><span class="hs-identifier hs-var">nls&#8321;</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754619"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754619"><span class="hs-identifier hs-var">fl&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754620"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754620"><span class="hs-identifier hs-var">mml&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754621"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754621"><span class="hs-identifier hs-var">ll&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754622"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754622"><span class="hs-identifier hs-var">nls&#8321;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754623"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754623"><span class="hs-identifier hs-var">fl&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754624"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754624"><span class="hs-identifier hs-var">mml&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754625"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754625"><span class="hs-identifier hs-var">ll&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754626"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754626"><span class="hs-identifier hs-var">nls&#8322;</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754622"><span class="hs-identifier hs-var">nls&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="UVMHS.Core.Classes.Order.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754626"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754619"><span class="hs-identifier hs-var">fl&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754623"><span class="hs-identifier hs-var">fl&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754620"><span class="hs-identifier hs-var">mml&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754624"><span class="hs-identifier hs-var">mml&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754625"><span class="hs-identifier hs-var">ll&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754621"><span class="hs-identifier hs-var">ll&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754622"><span class="hs-identifier hs-var">nls&#8321;</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754622"><span class="hs-identifier hs-var">nls&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="UVMHS.Core.Classes.Order.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754626"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754619"><span class="hs-identifier hs-var">fl&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754623"><span class="hs-identifier hs-var">fl&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754620"><span class="hs-identifier hs-var">mml&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754624"><span class="hs-identifier hs-var">mml&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754621"><span class="hs-identifier hs-var">ll&#8321;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754625"><span class="hs-identifier hs-var">ll&#8322;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754626"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754619"><span class="hs-identifier hs-var">fl&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754623"><span class="hs-identifier hs-var">fl&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754620"><span class="hs-identifier hs-var">mml&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754624"><span class="hs-identifier hs-var">mml&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754621"><span class="hs-identifier hs-var">ll&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754625"><span class="hs-identifier hs-var">ll&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(&#8469;64 -&gt; ShapeM) -&gt; &#8469;64 -&gt; ShapeM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754622"><span class="hs-identifier hs-var">nls&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Join a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Lattice.html#%2294"><span class="hs-operator hs-var">&#8852;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754626"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">------------</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- ShapeA --</span><span>
</span><span id="line-125"></span><span class="hs-comment">------------</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- A non-aligned shape looks like:</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-130"></span><span class="hs-comment">--     YY</span><span>
</span><span id="line-131"></span><span class="hs-comment">--     ZZZZ</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- An aligned shape looks like:</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-136"></span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;YY</span><span>
</span><span id="line-137"></span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;ZZZZ</span><span>
</span><span id="line-138"></span><span class="hs-comment">--</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- Shapes can be combined, which may affect alignment:</span><span>
</span><span id="line-140"></span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span class="hs-comment">--     non-aligned + non-aligned = non-aligned</span><span>
</span><span id="line-142"></span><span class="hs-comment">--     non-aligned + aligned     = non-aligned</span><span>
</span><span id="line-143"></span><span class="hs-comment">--     aligned     + non-aligned = aligned</span><span>
</span><span id="line-144"></span><span class="hs-comment">--     aligned     + aligned     = aligned</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- When the shape is a single line, it is always non-aligned</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- (so, aligned = False)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="ShapeA"><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-var">ShapeA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ShapeA"><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-var">ShapeA</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="shapeIAligned"><span class="annot"><span class="annottext">ShapeA -&gt; Bool
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeIAligned"><span class="hs-identifier hs-var hs-var">shapeIAligned</span></a></span></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D539"><span class="hs-identifier hs-type">&#120121;</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="shapeIShape"><span class="annot"><span class="annottext">ShapeA -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeIShape"><span class="hs-identifier hs-var hs-var">shapeIShape</span></a></span></span><span>   </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680754634"><span id="local-6989586621680754639"><span class="annot"><span class="annottext">ShapeA -&gt; ShapeA -&gt; Bool
(ShapeA -&gt; ShapeA -&gt; Bool)
-&gt; (ShapeA -&gt; ShapeA -&gt; Bool) -&gt; Eq ShapeA
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ShapeA -&gt; ShapeA -&gt; Bool
== :: ShapeA -&gt; ShapeA -&gt; Bool
$c/= :: ShapeA -&gt; ShapeA -&gt; Bool
/= :: ShapeA -&gt; ShapeA -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680754645"><span id="local-6989586621680754650"><span id="local-6989586621680754654"><span id="local-6989586621680754658"><span id="local-6989586621680754661"><span id="local-6989586621680754664"><span id="local-6989586621680754667"><span class="annot"><span class="annottext">Eq ShapeA
Eq ShapeA =&gt;
(ShapeA -&gt; ShapeA -&gt; Ordering)
-&gt; (ShapeA -&gt; ShapeA -&gt; Bool)
-&gt; (ShapeA -&gt; ShapeA -&gt; Bool)
-&gt; (ShapeA -&gt; ShapeA -&gt; Bool)
-&gt; (ShapeA -&gt; ShapeA -&gt; Bool)
-&gt; (ShapeA -&gt; ShapeA -&gt; ShapeA)
-&gt; (ShapeA -&gt; ShapeA -&gt; ShapeA)
-&gt; Ord ShapeA
ShapeA -&gt; ShapeA -&gt; Bool
ShapeA -&gt; ShapeA -&gt; Ordering
ShapeA -&gt; ShapeA -&gt; ShapeA
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: ShapeA -&gt; ShapeA -&gt; Ordering
compare :: ShapeA -&gt; ShapeA -&gt; Ordering
$c&lt; :: ShapeA -&gt; ShapeA -&gt; Bool
&lt; :: ShapeA -&gt; ShapeA -&gt; Bool
$c&lt;= :: ShapeA -&gt; ShapeA -&gt; Bool
&lt;= :: ShapeA -&gt; ShapeA -&gt; Bool
$c&gt; :: ShapeA -&gt; ShapeA -&gt; Bool
&gt; :: ShapeA -&gt; ShapeA -&gt; Bool
$c&gt;= :: ShapeA -&gt; ShapeA -&gt; Bool
&gt;= :: ShapeA -&gt; ShapeA -&gt; Bool
$cmax :: ShapeA -&gt; ShapeA -&gt; ShapeA
max :: ShapeA -&gt; ShapeA -&gt; ShapeA
$cmin :: ShapeA -&gt; ShapeA -&gt; ShapeA
min :: ShapeA -&gt; ShapeA -&gt; ShapeA
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680754670"><span id="local-6989586621680754676"><span id="local-6989586621680754680"><span class="annot"><span class="annottext">Int -&gt; ShapeA -&gt; ShowS
[ShapeA] -&gt; ShowS
ShapeA -&gt; String
(Int -&gt; ShapeA -&gt; ShowS)
-&gt; (ShapeA -&gt; String) -&gt; ([ShapeA] -&gt; ShowS) -&gt; Show ShapeA
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ShapeA -&gt; ShowS
showsPrec :: Int -&gt; ShapeA -&gt; ShowS
$cshow :: ShapeA -&gt; String
show :: ShapeA -&gt; String
$cshowList :: [ShapeA] -&gt; ShowS
showList :: [ShapeA] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span id="shapeIAlignedL"><span id="shapeIShapeL"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ShapeA</span></span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#Null"><span class="hs-identifier hs-type">Null</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680754691"><span class="annot"><span class="annottext">null :: ShapeA
</span><a href="UVMHS.Core.Classes.Monoid.html#null"><span class="hs-identifier hs-var hs-var hs-var hs-var">null</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Shape -&gt; ShapeA
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-var">ShapeA</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Shape
forall a. Null a =&gt; a
</span><a href="UVMHS.Core.Classes.Monoid.html#null"><span class="hs-identifier hs-var">null</span></a></span><span>
</span><span id="line-157"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span> </span><span id="local-6989586621680754701"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680754701"><span class="hs-identifier hs-var">a&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754702"><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754702"><span class="hs-identifier hs-var">sh&#8321;</span></a></span></span><span> </span><span id="local-6989586621680754703"><span class="annot"><span class="annottext">&#10746; :: ShapeA -&gt; ShapeA -&gt; ShapeA
</span><a href="UVMHS.Core.Classes.Monoid.html#%29FA"><span class="hs-operator hs-var hs-var hs-var hs-var">&#10746;</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span> </span><span id="local-6989586621680754704"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680754704"><span class="hs-identifier hs-var">a&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754705"><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754705"><span class="hs-identifier hs-var">sh&#8322;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680754706"><span class="annot"><span class="annottext">sh&#8322;' :: Shape
</span><a href="#local-6989586621680754706"><span class="hs-identifier hs-var hs-var">sh&#8322;'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="UVMHS.Core.Init.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680754704"><span class="hs-identifier hs-var">a&#8322;</span></a></span><span>
</span><span id="line-161"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is single-line</span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is single-line</span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX  &#10746;  &#9633;&#9633;&#9633;&#9633;AAA  =  &#9633;&#9633;&#9633;&#9633;XXXAAA</span><span>
</span><span id="line-165"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is single-line</span><span>
</span><span id="line-167"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is multiline non-aligned</span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX  &#10746;  &#9633;&#9633;&#9633;&#9633;AAA  =  &#9633;&#9633;&#9633;&#9633;XXXAAA</span><span>
</span><span id="line-170"></span><span>          </span><span class="hs-comment">--                 BB          BB</span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-comment">--                 CCCC        CCCC</span><span>
</span><span id="line-172"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is multiline non-aligned</span><span>
</span><span id="line-174"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is single-line</span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX  &#10746; &#9633;&#9633;&#9633;&#9633;AAA  =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-177"></span><span>          </span><span class="hs-comment">--     YY                     YY</span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-comment">--     ZZZZ                   ZZZZAAA</span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is multiline non-aligned</span><span>
</span><span id="line-181"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is multiline non-aligned</span><span>
</span><span id="line-182"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX  &#10746;  &#9633;&#9633;&#9633;&#9633;AAA  =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-183"></span><span>          </span><span class="hs-comment">--     YY          BB          YY</span><span>
</span><span id="line-184"></span><span>          </span><span class="hs-comment">--     ZZZZ        CCCC        ZZZZAAA</span><span>
</span><span id="line-185"></span><span>          </span><span class="hs-comment">--                             BB</span><span>
</span><span id="line-186"></span><span>          </span><span class="hs-comment">--                             CCCC</span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is multiline aligned</span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is single-line</span><span>
</span><span id="line-190"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX   &#10746;  &#9633;&#9633;&#9633;&#9633;AAA  =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-192"></span><span>          </span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;YY                   &#8901;&#8901;&#8901;&#8901;YY</span><span>
</span><span id="line-193"></span><span>          </span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;ZZZZ                 &#8901;&#8901;&#8901;&#8901;ZZZZAAA</span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is multiline aligned</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is multiline non-aligned</span><span>
</span><span id="line-197"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX   &#10746;  &#9633;&#9633;&#9633;&#9633;AAA  =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;YY       BB          &#8901;&#8901;&#8901;&#8901;YY</span><span>
</span><span id="line-200"></span><span>          </span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;ZZZZ     CCCC        &#8901;&#8901;&#8901;&#8901;ZZZZAAA</span><span>
</span><span id="line-201"></span><span>          </span><span class="hs-comment">--                              &#8901;&#8901;&#8901;&#8901;BB</span><span>
</span><span id="line-202"></span><span>          </span><span class="hs-comment">--                              &#8901;&#8901;&#8901;&#8901;CCCC</span><span>
</span><span id="line-203"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754705"><span class="hs-identifier hs-var">sh&#8322;</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is single-lined</span><span>
</span><span id="line-206"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is multiline aligned</span><span>
</span><span id="line-207"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX  &#10746;   &#9633;&#9633;&#9633;&#9633;AAA   =  &#9633;&#9633;&#9633;&#9633;XXXAAA</span><span>
</span><span id="line-209"></span><span>          </span><span class="hs-comment">--                  &#8901;&#8901;&#8901;&#8901;BB       &#8901;&#8901;&#8901;&#8901;&#9251;&#9251;&#9251;BB</span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-comment">--                  &#8901;&#8901;&#8901;&#8901;CCCC     &#8901;&#8901;&#8901;&#8901;&#9251;&#9251;&#9251;CCCC</span><span>
</span><span id="line-211"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is multiline non-aligned</span><span>
</span><span id="line-213"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is multiline aligned</span><span>
</span><span id="line-214"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX  &#10746;  &#9633;&#9633;&#9633;&#9633;AAA   =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-216"></span><span>          </span><span class="hs-comment">--     YY          &#8901;&#8901;&#8901;&#8901;BB       YY</span><span>
</span><span id="line-217"></span><span>          </span><span class="hs-comment">--     ZZZZ        &#8901;&#8901;&#8901;&#8901;CCCC     ZZZZAAA</span><span>
</span><span id="line-218"></span><span>          </span><span class="hs-comment">--                              &#9251;&#9251;&#9251;&#9251;BB</span><span>
</span><span id="line-219"></span><span>          </span><span class="hs-comment">--                              &#9251;&#9251;&#9251;&#9251;CCCC</span><span>
</span><span id="line-220"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-221"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8321; is multiline aligned</span><span>
</span><span id="line-222"></span><span>          </span><span class="hs-comment">-- &#8227; sh&#8322; is multiline aligned</span><span>
</span><span id="line-223"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span>          </span><span class="hs-comment">--     &#9633;&#9633;&#9633;&#9633;XXX   &#10746;  &#9633;&#9633;&#9633;&#9633;AAA   =  &#9633;&#9633;&#9633;&#9633;XXX</span><span>
</span><span id="line-225"></span><span>          </span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;YY       &#8901;&#8901;&#8901;&#8901;BB       &#8901;&#8901;&#8901;&#8901;YY</span><span>
</span><span id="line-226"></span><span>          </span><span class="hs-comment">--     &#8901;&#8901;&#8901;&#8901;ZZZZ     &#8901;&#8901;&#8901;&#8901;CCCC     &#8901;&#8901;&#8901;&#8901;ZZZZAAA</span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-comment">--                               &#8901;&#8901;&#8901;&#8901;&#9251;&#9251;&#9251;&#9251;BB</span><span>
</span><span id="line-228"></span><span>          </span><span class="hs-comment">--                               &#8901;&#8901;&#8901;&#8901;&#9251;&#9251;&#9251;&#9251;CCCC</span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-keyword">else</span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754705"><span class="hs-identifier hs-var">sh&#8322;</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>              </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-type">MultiLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-type">ShapeM</span></a></span><span> </span><span id="local-6989586621680754708"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754708"><span class="hs-identifier hs-var">fl&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754709"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754709"><span class="hs-identifier hs-var">mml&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754710"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754710"><span class="hs-identifier hs-var">ll&#8322;</span></a></span></span><span> </span><span id="local-6989586621680754711"><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754711"><span class="hs-identifier hs-var">nls&#8322;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span>
</span><span id="line-233"></span><span>                </span><span class="annot"><span class="annottext">ShapeM -&gt; Shape
</span><a href="UVMHS.Lib.Pretty.Shape.html#MultiLine"><span class="hs-identifier hs-var">MultiLine</span></a></span><span> </span><span class="annot"><span class="annottext">(ShapeM -&gt; Shape) -&gt; ShapeM -&gt; Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; &#8469;64 -&gt; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeM"><span class="hs-identifier hs-var">ShapeM</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754708"><span class="hs-identifier hs-var">fl&#8322;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeLastLength"><span class="hs-identifier hs-var">shapeLastLength</span></a></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754702"><span class="hs-identifier hs-var">sh&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Plus a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754709"><span class="hs-identifier hs-var">mml&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Shape -&gt; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#shapeLastLength"><span class="hs-identifier hs-var">shapeLastLength</span></a></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754702"><span class="hs-identifier hs-var">sh&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64 -&gt; &#8469;64 -&gt; &#8469;64
forall a. Plus a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Arithmetic.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754710"><span class="hs-identifier hs-var">ll&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#8469;64
</span><a href="#local-6989586621680754711"><span class="hs-identifier hs-var">nls&#8322;</span></a></span><span>
</span><span id="line-234"></span><span>              </span><span class="annot"><span class="annottext">Shape
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#120138; -&gt; Shape
forall a. STACK =&gt; &#120138; -&gt; a
</span><a href="UVMHS.Core.Init.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">&#120138;
</span><span class="hs-string">&quot;internal error&quot;</span></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Shape -&gt; ShapeA
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-var">ShapeA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680754701"><span class="hs-identifier hs-var">a&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="UVMHS.Core.Init.html#%2A54"><span class="hs-operator hs-var">&#10836;</span></a></span><span> </span><span class="annot"><span class="annottext">(Shape &#9010; &#8469;64) -&gt; Shape -&gt; Bool
forall a b. (a &#9010; b) -&gt; a -&gt; Bool
</span><a href="UVMHS.Core.Data.Lens.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="annot"><span class="annottext">Shape &#9010; &#8469;64
</span><a href="UVMHS.Lib.Pretty.Shape.html#singleLineL"><span class="hs-identifier hs-var">singleLineL</span></a></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754702"><span class="hs-identifier hs-var">sh&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="UVMHS.Core.Init.html#%2A53"><span class="hs-operator hs-var">&#10835;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680754704"><span class="hs-identifier hs-var">a&#8322;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Shape -&gt; ShapeA) -&gt; Shape -&gt; ShapeA
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754702"><span class="hs-identifier hs-var">sh&#8321;</span></a></span><span> </span><span class="annot"><span class="annottext">Shape -&gt; Shape -&gt; Shape
forall a. Append a =&gt; a -&gt; a -&gt; a
</span><a href="UVMHS.Core.Classes.Monoid.html#%29FA"><span class="hs-operator hs-var">&#10746;</span></a></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754706"><span class="hs-identifier hs-var">sh&#8322;'</span></a></span><span>
</span><span id="line-236"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Monoid.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#alignShapeA"><span class="hs-identifier hs-type">alignShapeA</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span>
</span><span id="line-239"></span><span id="alignShapeA"><span class="annot"><span class="annottext">alignShapeA :: ShapeA -&gt; ShapeA
</span><a href="UVMHS.Lib.Pretty.Shape.html#alignShapeA"><span class="hs-identifier hs-var hs-var">alignShapeA</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-type">ShapeA</span></a></span><span> </span><span id="local-6989586621680754722"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680754722"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680754723"><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754723"><span class="hs-identifier hs-var">sh</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Shape &#9010; ShapeM) -&gt; Shape -&gt; Bool
forall a b. (a &#9010; b) -&gt; a -&gt; Bool
</span><a href="UVMHS.Core.Data.Lens.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="annot"><span class="annottext">Shape &#9010; ShapeM
</span><a href="UVMHS.Lib.Pretty.Shape.html#multiLineL"><span class="hs-identifier hs-var">multiLineL</span></a></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754723"><span class="hs-identifier hs-var">sh</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Shape -&gt; ShapeA
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-var">ShapeA</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754723"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Shape -&gt; ShapeA
</span><a href="UVMHS.Lib.Pretty.Shape.html#ShapeA"><span class="hs-identifier hs-var">ShapeA</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680754722"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621680754723"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-242"></span></pre></body></html>