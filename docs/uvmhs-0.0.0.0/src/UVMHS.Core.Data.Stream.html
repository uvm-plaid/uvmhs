<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">UVMHS.Core.Data.Stream</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html"><span class="hs-identifier">UVMHS.Core.Init</span></a></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.html"><span class="hs-identifier">UVMHS.Core.Classes</span></a></span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span id="local-6989586621680234630"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680234574"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680234630"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8658;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234630"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680234571"><span class="annot"><span class="annottext">== :: &#119878; a -&gt; &#119878; a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; a -&gt; Bool
forall a. Eq a =&gt; &#119878; a -&gt; &#119878; a -&gt; Bool
</span><a href="UVMHS.Core.Data.Stream.html#eq%1D446"><span class="hs-identifier hs-var">eq&#119878;</span></a></span></span><span>
</span><span id="line-9"></span><span id="local-6989586621680234628"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680234555"><span id="local-6989586621680234557"><span id="local-6989586621680234559"><span id="local-6989586621680234561"><span id="local-6989586621680234563"><span id="local-6989586621680234565"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680234628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8658;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680234552"><span class="annot"><span class="annottext">compare :: &#119878; a -&gt; &#119878; a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; a -&gt; Ordering
forall a. Ord a =&gt; &#119878; a -&gt; &#119878; a -&gt; Ordering
</span><a href="UVMHS.Core.Data.Stream.html#compare%1D446"><span class="hs-identifier hs-var">compare&#119878;</span></a></span></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span id="local-6989586621680234622"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="UVMHS.Core.Classes.Collections.html#ToIter"><span class="hs-identifier hs-type">ToIter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680234546"><span class="annot"><span class="annottext">iter :: &#119878; a -&gt; &#119868; a
</span><a href="UVMHS.Core.Classes.Collections.html#iter"><span class="hs-identifier hs-var hs-var hs-var hs-var">iter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119868; a
forall a. &#119878; a -&gt; &#119868; a
</span><a href="UVMHS.Core.Data.Stream.html#iter%1D446"><span class="hs-identifier hs-var">iter&#119878;</span></a></span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span id="local-6989586621680234543"><span class="annot"><a href="UVMHS.Core.Data.Stream.html#eq%1D446"><span class="hs-identifier hs-type">eq&#119878;</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680234543"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8658;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D539"><span class="hs-identifier hs-type">&#120121;</span></a></span></span><span>
</span><span id="line-14"></span><span id="eq%1D446"><span class="annot"><span class="annottext">eq&#119878; :: forall a. Eq a =&gt; &#119878; a -&gt; &#119878; a -&gt; Bool
</span><a href="UVMHS.Core.Data.Stream.html#eq%1D446"><span class="hs-identifier hs-var hs-var">eq&#119878;</span></a></span></span><span> </span><span id="local-6989586621680234538"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234538"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680234537"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234537"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
forall a. &#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#un%1D446"><span class="hs-identifier hs-var hs-var">un&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234538"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">&#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
forall a. &#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#un%1D446"><span class="hs-identifier hs-var hs-var">un&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234537"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">,</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><span class="annottext">a &#8743; &#119878; a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><span class="annottext">a &#8743; &#119878; a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680234533"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234533"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680234531"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234531"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680234530"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234530"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680234529"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234529"><span class="hs-identifier hs-var">ys'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234533"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="UVMHS.Core.Classes.Order.html#%2261"><span class="hs-operator hs-var">&#8801;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234530"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; a -&gt; Bool
forall a. Eq a =&gt; &#119878; a -&gt; &#119878; a -&gt; Bool
</span><a href="UVMHS.Core.Data.Stream.html#eq%1D446"><span class="hs-identifier hs-var">eq&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234531"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234529"><span class="hs-identifier hs-var">ys'</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span id="local-6989586621680234527"><span class="annot"><a href="UVMHS.Core.Data.Stream.html#compare%1D446"><span class="hs-identifier hs-type">compare&#119878;</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680234527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8658;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span><span>
</span><span id="line-23"></span><span id="compare%1D446"><span class="annot"><span class="annottext">compare&#119878; :: forall a. Ord a =&gt; &#119878; a -&gt; &#119878; a -&gt; Ordering
</span><a href="UVMHS.Core.Data.Stream.html#compare%1D446"><span class="hs-identifier hs-var hs-var">compare&#119878;</span></a></span></span><span> </span><span id="local-6989586621680234523"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234523"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680234522"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234522"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
forall a. &#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#un%1D446"><span class="hs-identifier hs-var hs-var">un&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234523"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">&#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
forall a. &#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#un%1D446"><span class="hs-identifier hs-var hs-var">un&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234522"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">,</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><span class="annottext">a &#8743; &#119878; a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><span class="annottext">a &#8743; &#119878; a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680234521"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234521"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680234520"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234520"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680234519"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234519"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680234518"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234518"><span class="hs-identifier hs-var">ys'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234521"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="UVMHS.Core.Classes.Order.html#%22DA"><span class="hs-operator hs-var">&#8922;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234519"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; a -&gt; Ordering
forall a. Ord a =&gt; &#119878; a -&gt; &#119878; a -&gt; Ordering
</span><a href="UVMHS.Core.Data.Stream.html#compare%1D446"><span class="hs-identifier hs-var">compare&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234520"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234518"><span class="hs-identifier hs-var">ys'</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="annot"><a href="UVMHS.Core.Data.Stream.html#stream%1D43C"><span class="hs-identifier hs-type">stream&#119868;</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-keyword">&#8704;</span><span> </span><span id="local-6989586621680234614"><span class="annot"><a href="#local-6989586621680234614"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D43C"><span class="hs-identifier hs-type">&#119868;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234614"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234614"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-33"></span><span id="stream%1D43C"><span class="annot"><span class="annottext">stream&#119868; :: forall a. &#119868; a -&gt; &#119878; a
</span><a href="UVMHS.Core.Data.Stream.html#stream%1D43C"><span class="hs-identifier hs-var hs-var">stream&#119868;</span></a></span></span><span> </span><span id="local-6989586621680234515"><span class="annot"><span class="annottext">&#119868; a
</span><a href="#local-6989586621680234515"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#119868; a -&gt; forall b. (a -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b
forall a.
&#119868; a -&gt; forall b. (a -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b
</span><a href="UVMHS.Core.Init.html#un%1D43C"><span class="hs-identifier hs-var hs-var">un&#119868;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119868; a
</span><a href="#local-6989586621680234515"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680234513"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234513"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680234512"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234512"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680234511"><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; a
</span><a href="#local-6989586621680234511"><span class="hs-identifier hs-var">&#120000;</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">(() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a
forall a. (() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a
</span><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-var">&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a) -&gt; (() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">(a &#8743; &#119878; a) -&gt; &#119874; (a &#8743; &#119878; a)
forall a. a -&gt; &#119874; a
</span><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">((a &#8743; &#119878; a) -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; (a &#8743; &#119878; a) -&gt; &#119874; (a &#8743; &#119878; a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234513"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; &#119878; a -&gt; a &#8743; &#119878; a
forall a b. a -&gt; b -&gt; a &#8743; b
</span><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; a
</span><a href="#local-6989586621680234511"><span class="hs-identifier hs-var">&#120000;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234512"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a
forall a. (() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a
</span><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-var">&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a) -&gt; (() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
forall a. &#119874; a
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; a
forall a. a -&gt; a
</span><a href="UVMHS.Core.Init.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span id="local-6989586621680234507"><span class="annot"><a href="UVMHS.Core.Data.Stream.html#iter%1D446"><span class="hs-identifier hs-type">iter&#119878;</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D43C"><span class="hs-identifier hs-type">&#119868;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234507"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-36"></span><span id="iter%1D446"><span class="annot"><span class="annottext">iter&#119878; :: forall a. &#119878; a -&gt; &#119868; a
</span><a href="UVMHS.Core.Data.Stream.html#iter%1D446"><span class="hs-identifier hs-var hs-var">iter&#119878;</span></a></span></span><span> </span><span id="local-6989586621680234506"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234506"><span class="hs-identifier hs-var">xs&#8320;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall b. (a -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; &#119868; a
forall a.
(forall b. (a -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; &#119868; a
</span><a href="UVMHS.Core.Init.html#%1D43C"><span class="hs-identifier hs-var">&#119868;</span></a></span><span> </span><span class="annot"><span class="annottext">((forall b. (a -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b)
 -&gt; &#119868; a)
-&gt; (forall b. (a -&gt; b -&gt; (b -&gt; b) -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b)
-&gt; &#119868; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">HS.$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680234504"><span class="annot"><span class="annottext">a -&gt; b -&gt; (b -&gt; b) -&gt; b
</span><a href="#local-6989586621680234504"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">((b -&gt; b) -&gt; b -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="UVMHS.Core.Init.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">(((b -&gt; b) -&gt; b -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b)
-&gt; ((b -&gt; b) -&gt; b -&gt; b) -&gt; b -&gt; (b -&gt; b) -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680234502"><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621680234502"><span class="hs-identifier hs-var">&#120000;</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680234501"><span class="annot"><span class="annottext">loop :: &#119878; a -&gt; b -&gt; b
</span><a href="#local-6989586621680234501"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621680234500"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234500"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680234499"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680234499"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
forall a. &#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#un%1D446"><span class="hs-identifier hs-var hs-var">un&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234500"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><span class="annottext">&#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621680234502"><span class="hs-identifier hs-var">&#120000;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680234499"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680234498"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234498"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680234497"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234497"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span>
</span><span id="line-40"></span><span>          </span><span class="annot"><span class="annottext">a -&gt; b -&gt; (b -&gt; b) -&gt; b
</span><a href="#local-6989586621680234504"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234498"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680234499"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">((b -&gt; b) -&gt; b) -&gt; (b -&gt; b) -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680234496"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680234496"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">&#8594;</span><span>
</span><span id="line-41"></span><span>          </span><span class="annot"><span class="annottext">&#119878; a -&gt; b -&gt; b
</span><a href="#local-6989586621680234501"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234497"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680234496"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; b -&gt; b
</span><a href="#local-6989586621680234501"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234506"><span class="hs-identifier hs-var">xs&#8320;</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span id="local-6989586621680234593"><span id="local-6989586621680234594"><span id="local-6989586621680234595"><span class="annot"><a href="UVMHS.Core.Data.Stream.html#zipWith%1D446"><span class="hs-identifier hs-type">zipWith&#119878;</span></a></span><span> </span><span class="hs-glyph">&#8759;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680234595"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="#local-6989586621680234594"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="#local-6989586621680234593"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234595"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234594"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-type">&#119878;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680234593"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-45"></span><span id="zipWith%1D446"><span class="annot"><span class="annottext">zipWith&#119878; :: forall a b c. (a -&gt; b -&gt; c) -&gt; &#119878; a -&gt; &#119878; b -&gt; &#119878; c
</span><a href="UVMHS.Core.Data.Stream.html#zipWith%1D446"><span class="hs-identifier hs-var hs-var">zipWith&#119878;</span></a></span></span><span> </span><span id="local-6989586621680234494"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621680234494"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; b -&gt; &#119878; c
</span><a href="#local-6989586621680234493"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621680234493"><span class="annot"><span class="annottext">loop :: &#119878; a -&gt; &#119878; b -&gt; &#119878; c
</span><a href="#local-6989586621680234493"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621680234492"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234492"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680234491"><span class="annot"><span class="annottext">&#119878; b
</span><a href="#local-6989586621680234491"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() -&gt; &#119874; (c &#8743; &#119878; c)) -&gt; &#119878; c
forall a. (() -&gt; &#119874; (a &#8743; &#119878; a)) -&gt; &#119878; a
</span><a href="UVMHS.Core.Init.html#%1D446"><span class="hs-identifier hs-var">&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; &#119874; (c &#8743; &#119878; c)) -&gt; &#119878; c) -&gt; (() -&gt; &#119874; (c &#8743; &#119878; c)) -&gt; &#119878; c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="UVMHS.Core.Init.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">&#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
forall a. &#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#un%1D446"><span class="hs-identifier hs-var hs-var">un&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234492"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">&#119878; b -&gt; () -&gt; &#119874; (b &#8743; &#119878; b)
forall a. &#119878; a -&gt; () -&gt; &#119874; (a &#8743; &#119878; a)
</span><a href="UVMHS.Core.Init.html#un%1D446"><span class="hs-identifier hs-var hs-var">un&#119878;</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; b
</span><a href="#local-6989586621680234491"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-48"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680234490"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234490"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680234489"><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234489"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680234488"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680234488"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680234487"><span class="annot"><span class="annottext">&#119878; b
</span><a href="#local-6989586621680234487"><span class="hs-identifier hs-var">ys'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">(c &#8743; &#119878; c) -&gt; &#119874; (c &#8743; &#119878; c)
forall a. a -&gt; &#119874; a
</span><a href="UVMHS.Core.Init.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621680234494"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680234490"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680234488"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; &#119878; c -&gt; c &#8743; &#119878; c
forall a b. a -&gt; b -&gt; a &#8743; b
</span><a href="UVMHS.Core.Init.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a -&gt; &#119878; b -&gt; &#119878; c
</span><a href="#local-6989586621680234493"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; a
</span><a href="#local-6989586621680234489"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">&#119878; b
</span><a href="#local-6989586621680234487"><span class="hs-identifier hs-var">ys'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><span class="annottext">(&#119874; (a &#8743; &#119878; a), &#119874; (b &#8743; &#119878; b))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><span class="annottext">&#119874; (c &#8743; &#119878; c)
forall a. &#119874; a
</span><a href="UVMHS.Core.Init.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-50"></span><span>          </span><span>
</span><span id="line-51"></span><span class="hs-comment">-- import UVMHS.Core.Init</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- import UVMHS.Core.Classes</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- </span><span>
</span><span id="line-54"></span><span class="hs-comment">-- import UVMHS.Core.Data.Arithmetic ()</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- import UVMHS.Core.Data.LazyList ()</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- import UVMHS.Core.Data.Iter</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- import UVMHS.Core.Data.Option</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- import UVMHS.Core.Data.Pair</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- import UVMHS.Core.Data.String</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- </span><span>
</span><span id="line-61"></span><span class="hs-comment">-- instance (Eq a) &#8658; Eq (&#119878; a) where (==) = eqBy&#119878; (&#8801;)</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- instance (Ord a) &#8658; Ord (&#119878; a) where compare = compareBy&#119878; (&#8922;)</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- instance (Show a) &#8658; Show (&#119878; a) where show = chars &#8728; showWith&#119878; show&#120138;</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- </span><span>
</span><span id="line-65"></span><span class="hs-comment">-- instance Functor &#119878; where map = map&#119878;</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- </span><span>
</span><span id="line-67"></span><span class="hs-comment">-- instance Null (&#119878; a) where null = empty&#119878;</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- instance Append (&#119878; a) where (&#10746;) = append&#119878;</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- instance Monoid (&#119878; a)</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- </span><span>
</span><span id="line-71"></span><span class="hs-comment">-- instance Return &#119878; where return = single&#119878;</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- instance Bind &#119878; where (&#8811;=) = bind&#119878;</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- </span><span>
</span><span id="line-74"></span><span class="hs-comment">-- instance Single a (&#119878; a) where single = single&#119878;</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- </span><span>
</span><span id="line-76"></span><span class="hs-comment">-- instance ToStream a (&#119878; a) where stream = id</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- instance ToIter a (&#119878; a) where iter = iter&#119878;</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- </span><span>
</span><span id="line-79"></span><span class="hs-comment">-- empty&#119878; &#8759; &#119878; a</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- empty&#119878; = &#119878; () $ const None</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- </span><span>
</span><span id="line-82"></span><span class="hs-comment">-- single&#119878; &#8759; a &#8594; &#119878; a</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- single&#119878; x = &#119878; False $ \case</span><span>
</span><span id="line-84"></span><span class="hs-comment">--   False &#8594; Some $ x :* True</span><span>
</span><span id="line-85"></span><span class="hs-comment">--   True &#8594; None</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- </span><span>
</span><span id="line-87"></span><span class="hs-comment">-- append&#119878; &#8759; &#119878; a &#8594; &#119878; a &#8594; &#119878; a</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- append&#119878; (&#119878; s&#8321;&#8320; f&#8321;) (&#119878; s&#8322;&#8320; f&#8322;) = &#119878; (Inl s&#8321;&#8320;) $ \ s &#8594;</span><span>
</span><span id="line-89"></span><span class="hs-comment">--   let goLeft s&#8321; = case f&#8321; s&#8321; of</span><span>
</span><span id="line-90"></span><span class="hs-comment">--         None &#8594; goRight s&#8322;&#8320;</span><span>
</span><span id="line-91"></span><span class="hs-comment">--         Some (x :* s&#8321;') &#8594; Some (x :* Inl s&#8321;')</span><span>
</span><span id="line-92"></span><span class="hs-comment">--       goRight s&#8322; = case f&#8322; s&#8322; of</span><span>
</span><span id="line-93"></span><span class="hs-comment">--         None &#8594; None</span><span>
</span><span id="line-94"></span><span class="hs-comment">--         Some (x :* s&#8322;') &#8594; Some (x :* Inr s&#8322;')</span><span>
</span><span id="line-95"></span><span class="hs-comment">--   in case s of</span><span>
</span><span id="line-96"></span><span class="hs-comment">--     Inl s&#8321; &#8594; goLeft s&#8321;</span><span>
</span><span id="line-97"></span><span class="hs-comment">--     Inr s&#8322; &#8594; goRight s&#8322;</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- </span><span>
</span><span id="line-99"></span><span class="hs-comment">-- map&#119878; &#8759; (a &#8594; b) &#8594; &#119878; a &#8594; &#119878; b</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- map&#119878; f (&#119878; s&#8320; g) = &#119878; s&#8320; $ \ s &#8594; </span><span>
</span><span id="line-101"></span><span class="hs-comment">--   case g s of</span><span>
</span><span id="line-102"></span><span class="hs-comment">--     None &#8594; None</span><span>
</span><span id="line-103"></span><span class="hs-comment">--     Some (x:*s') &#8594; Some (f x:*s')</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- </span><span>
</span><span id="line-105"></span><span class="hs-comment">-- mjoin&#119878; &#8759; &#8704; a. &#119878; (&#119878; a) &#8594; &#119878; a</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- mjoin&#119878; (&#119878; (s&#8320; &#8759; s) (f &#8759; s &#8594; &#119874; (&#119878; a &#8743; s))) = &#119878; (&#119878; () (const None) :* s&#8320; &#8759; &#119878; a &#8743; s) $ \ (&#119878; t g :* s) &#8594; loop&#8321; t g s</span><span>
</span><span id="line-107"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-108"></span><span class="hs-comment">--     loop&#8321; &#8759; &#8704; s'. s' &#8594; (s' &#8594; &#119874; (a &#8743; s')) &#8594; s &#8594; &#119874; (a &#8743; (&#119878; a &#8743; s))</span><span>
</span><span id="line-109"></span><span class="hs-comment">--     loop&#8321; t g s = case g t of</span><span>
</span><span id="line-110"></span><span class="hs-comment">--       None &#8594; loop&#8322; s</span><span>
</span><span id="line-111"></span><span class="hs-comment">--       Some (x :* t') &#8594; Some (x :* (&#119878; t' g :* s))</span><span>
</span><span id="line-112"></span><span class="hs-comment">--     loop&#8322; &#8759; s &#8594; &#119874; (a &#8743; (&#119878; a &#8743; s))</span><span>
</span><span id="line-113"></span><span class="hs-comment">--     loop&#8322; s = case f s of</span><span>
</span><span id="line-114"></span><span class="hs-comment">--       None &#8594; None</span><span>
</span><span id="line-115"></span><span class="hs-comment">--       Some (&#119878; t g :* s') &#8594; loop&#8321; t g s'</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- </span><span>
</span><span id="line-117"></span><span class="hs-comment">-- bind&#119878; &#8759; &#119878; a &#8594; (a &#8594; &#119878; b) &#8594; &#119878; b</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- bind&#119878; xs k = mjoin&#119878; $ map&#119878; k xs</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- </span><span>
</span><span id="line-120"></span><span class="hs-comment">-- uncons&#119878; &#8759; &#119878; a &#8594; &#119874; (a &#8743; &#119878; a)</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- uncons&#119878; (&#119878; s g) = case g s of</span><span>
</span><span id="line-122"></span><span class="hs-comment">--   None &#8594; None</span><span>
</span><span id="line-123"></span><span class="hs-comment">--   Some (x :* s') &#8594; Some (x :* &#119878; s' g)</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- </span><span>
</span><span id="line-125"></span><span class="hs-comment">-- uncons &#8759; (ToStream a t) &#8658; t &#8594; &#119874; (a &#8743; &#119878; a)</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- uncons = uncons&#119878; &#8728; stream</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- </span><span>
</span><span id="line-128"></span><span class="hs-comment">-- eqBy&#119878; &#8759; (a &#8594; a &#8594; &#120121;) &#8594; &#119878; a &#8594; &#119878; a &#8594; &#120121;</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- eqBy&#119878; f (&#119878; s&#8321;&#8320; g&#8321;) (&#119878; s&#8322;&#8320; g&#8322;) = loop s&#8321;&#8320; s&#8322;&#8320;</span><span>
</span><span id="line-130"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-131"></span><span class="hs-comment">--     loop s&#8321; s&#8322; = case (g&#8321; s&#8321;,g&#8322; s&#8322;) of</span><span>
</span><span id="line-132"></span><span class="hs-comment">--       (None,None) &#8594; True</span><span>
</span><span id="line-133"></span><span class="hs-comment">--       (Some _,None) &#8594; False</span><span>
</span><span id="line-134"></span><span class="hs-comment">--       (None,Some _) &#8594; False</span><span>
</span><span id="line-135"></span><span class="hs-comment">--       (Some (x&#8321; :* s&#8321;'),Some (x&#8322; :* s&#8322;')) &#8594; case f x&#8321; x&#8322; of</span><span>
</span><span id="line-136"></span><span class="hs-comment">--         True &#8594; loop s&#8321;' s&#8322;' </span><span>
</span><span id="line-137"></span><span class="hs-comment">--         False &#8594; False</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- </span><span>
</span><span id="line-139"></span><span class="hs-comment">-- compareBy&#119878; &#8759; (a &#8594; a &#8594; Ordering) &#8594; &#119878; a &#8594; &#119878; a &#8594; Ordering</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- compareBy&#119878; f (&#119878; s&#8321;&#8320; g&#8321;) (&#119878; s&#8322;&#8320; g&#8322;) = loop s&#8321;&#8320; s&#8322;&#8320;</span><span>
</span><span id="line-141"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-142"></span><span class="hs-comment">--     loop s&#8321; s&#8322; = case (g&#8321; s&#8321;,g&#8322; s&#8322;) of</span><span>
</span><span id="line-143"></span><span class="hs-comment">--       (None,None) &#8594; EQ</span><span>
</span><span id="line-144"></span><span class="hs-comment">--       (None,Some _) &#8594; LT</span><span>
</span><span id="line-145"></span><span class="hs-comment">--       (Some _,None) &#8594; GT</span><span>
</span><span id="line-146"></span><span class="hs-comment">--       (Some (x&#8321; :* s&#8321;'),Some (x&#8322; :* s&#8322;')) &#8594; case f x&#8321; x&#8322; of</span><span>
</span><span id="line-147"></span><span class="hs-comment">--         LT &#8594; LT</span><span>
</span><span id="line-148"></span><span class="hs-comment">--         EQ &#8594; loop s&#8321;' s&#8322;'</span><span>
</span><span id="line-149"></span><span class="hs-comment">--         GT &#8594; GT</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- </span><span>
</span><span id="line-151"></span><span class="hs-comment">-- showWith&#119878; &#8759; (a &#8594; &#120138;) &#8594; &#119878; a &#8594; &#120138;</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- showWith&#119878; = showCollection &quot;&#119878;[&quot; &quot;]&quot; &quot;,&quot;</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- </span><span>
</span><span id="line-154"></span><span class="hs-comment">-- isEmpty &#8759; (ToStream a t) &#8658; t &#8594; &#120121;</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- isEmpty (stream &#8594; &#119878; s g) = isNone $ g s</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- </span><span>
</span><span id="line-157"></span><span class="hs-comment">-- naturals &#8759; &#119878; &#8469;</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- naturals = &#119878; 0 $ \ i &#8594; Some (i :* succ i)</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- </span><span>
</span><span id="line-160"></span><span class="hs-comment">-- zipWith :: (ToStream a t&#8321;,ToStream b t&#8322;) &#8658; (a &#8594; b &#8594; c) &#8594; t&#8321; &#8594; t&#8322; &#8594; &#119878; c</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- zipWith f (stream &#8594; &#119878; s&#8321;&#8320; g&#8321;) (stream &#8594; &#119878; s&#8322;&#8320; g&#8322;) = &#119878; (s&#8321;&#8320; :* s&#8322;&#8320;) $ \ (s&#8321; :* s&#8322;) &#8594; do</span><span>
</span><span id="line-162"></span><span class="hs-comment">--   (x :* s&#8321;') &#8592; g&#8321; s&#8321;</span><span>
</span><span id="line-163"></span><span class="hs-comment">--   (y :* s&#8322;') &#8592; g&#8322; s&#8322;</span><span>
</span><span id="line-164"></span><span class="hs-comment">--   return $ f x y :* (s&#8321;' :* s&#8322;')</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- </span><span>
</span><span id="line-166"></span><span class="hs-comment">-- zip &#8759; (ToStream a t&#8321;,ToStream b t&#8322;) &#8658; t&#8321; &#8594; t&#8322; &#8594; &#119878; (a &#8743; b)</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- zip = zipWith (:*)</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- </span><span>
</span><span id="line-169"></span><span class="hs-comment">-- zip3With &#8759; (ToStream a t&#8321;,ToStream b t&#8322;,ToStream c t&#8323;) &#8658; (a &#8594; b &#8594; c &#8594; d) &#8594; t&#8321; &#8594; t&#8322; &#8594; t&#8323; &#8594; &#119878; d</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- zip3With f (stream &#8594; &#119878; s&#8321;&#8320; g&#8321;) (stream &#8594; &#119878; s&#8322;&#8320; g&#8322;) (stream &#8594; &#119878; s&#8323;&#8320; g&#8323;) =</span><span>
</span><span id="line-171"></span><span class="hs-comment">--   &#119878; (s&#8321;&#8320; :* s&#8322;&#8320; :* s&#8323;&#8320;) $ \ (s&#8321; :* s&#8322; :* s&#8323;) &#8594; do</span><span>
</span><span id="line-172"></span><span class="hs-comment">--     (x :* s&#8321;') &#8592; g&#8321; s&#8321;</span><span>
</span><span id="line-173"></span><span class="hs-comment">--     (y :* s&#8322;') &#8592; g&#8322; s&#8322;</span><span>
</span><span id="line-174"></span><span class="hs-comment">--     (z :* s&#8323;') &#8592; g&#8323; s&#8323;</span><span>
</span><span id="line-175"></span><span class="hs-comment">--     return $ f x y z :* (s&#8321;' :* s&#8322;' :* s&#8323;')</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- </span><span>
</span><span id="line-177"></span><span class="hs-comment">-- zip3 &#8759; (ToStream a t&#8321;,ToStream b t&#8322;,ToStream c t&#8323;) &#8658; t&#8321; &#8594; t&#8322; &#8594; t&#8323; &#8594; &#119878; (a &#8743; b &#8743; c)</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- zip3 = zip3With $ (:*) &#8728;&#8728; (:*)</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- </span><span>
</span><span id="line-180"></span><span class="hs-comment">-- firstN &#8759; (ToStream a t) &#8658; &#8469; &#8594; t &#8594; &#119878; a</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- firstN n&#8320; (stream &#8594; &#119878; s&#8320; g) = &#119878; (s&#8320; :* 0) $ \ (s :* n) &#8594; case n &#8801; n&#8320; of</span><span>
</span><span id="line-182"></span><span class="hs-comment">--   True &#8594; None </span><span>
</span><span id="line-183"></span><span class="hs-comment">--   False &#8594; do</span><span>
</span><span id="line-184"></span><span class="hs-comment">--     (x :* s') &#8592; g s</span><span>
</span><span id="line-185"></span><span class="hs-comment">--     return (x :* (s' :* succ n))</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- </span><span>
</span><span id="line-187"></span><span class="hs-comment">-- lastN &#8759; (ToStream a t) &#8658; &#8469; &#8594; t &#8594; &#119868; a</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- lastN n = reverse &#8728; firstN n &#8728; list &#8728; reverse &#8728; stream</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- </span><span>
</span><span id="line-190"></span><span class="hs-comment">-- skipN &#8759; (ToStream a t) &#8658; &#8469; &#8594; t &#8594; &#119878; a</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- skipN n&#8320; (stream &#8594; &#119878; s&#8320; g) = &#119878; (loop 0 s&#8320;) g</span><span>
</span><span id="line-192"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-193"></span><span class="hs-comment">--     loop n s </span><span>
</span><span id="line-194"></span><span class="hs-comment">--       | n &#8801; n&#8320; = s </span><span>
</span><span id="line-195"></span><span class="hs-comment">--       | otherwise = ifNone s $ do</span><span>
</span><span id="line-196"></span><span class="hs-comment">--           s' &#8592; snd ^$ g s</span><span>
</span><span id="line-197"></span><span class="hs-comment">--           return $ loop (succ n) s'</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- </span><span>
</span><span id="line-199"></span><span class="hs-comment">-- stripPrefix&#119878; &#8759; (Eq a,ToStream a t&#8321;,ToStream a t&#8322;) &#8658; t&#8321; &#8594; t&#8322; &#8594; &#119874; (&#119878; a)</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- stripPrefix&#119878; (stream &#8594; &#119878; s&#8321;&#8320; g&#8321;) (stream &#8594; &#119878; s&#8322;&#8320; g&#8322;) = loop s&#8321;&#8320; s&#8322;&#8320;</span><span>
</span><span id="line-201"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-202"></span><span class="hs-comment">--     loop s&#8321; s&#8322; = case g&#8321; s&#8321; of</span><span>
</span><span id="line-203"></span><span class="hs-comment">--       None &#8594; Some $ &#119878; s&#8322; g&#8322;</span><span>
</span><span id="line-204"></span><span class="hs-comment">--       Some (x :* s&#8321;') &#8594; do</span><span>
</span><span id="line-205"></span><span class="hs-comment">--         (y :* s&#8322;') &#8592; g&#8322; s&#8322;</span><span>
</span><span id="line-206"></span><span class="hs-comment">--         case x &#8801; y of</span><span>
</span><span id="line-207"></span><span class="hs-comment">--           True &#8594; loop s&#8321;' s&#8322;' </span><span>
</span><span id="line-208"></span><span class="hs-comment">--           False &#8594; None</span><span>
</span><span id="line-209"></span><span class="hs-comment">--     </span><span>
</span><span id="line-210"></span><span class="hs-comment">-- prefixBefore&#119878; &#8759; (ToStream a t) &#8658; (a &#8594; &#120121;) &#8594; t &#8594; &#119878; a</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- prefixBefore&#119878; p (stream &#8594; &#119878; s&#8320; g) = &#119878; s&#8320; $ \ s &#8594; do</span><span>
</span><span id="line-212"></span><span class="hs-comment">--   (x :* s') &#8592; g s</span><span>
</span><span id="line-213"></span><span class="hs-comment">--   case p x of</span><span>
</span><span id="line-214"></span><span class="hs-comment">--     True &#8594; None </span><span>
</span><span id="line-215"></span><span class="hs-comment">--     False &#8594; Some (x :* s')</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- </span><span>
</span><span id="line-217"></span><span class="hs-comment">-- prefixBeforeN&#119878; &#8759; (ToStream a t) &#8658; &#8469; &#8594; (a &#8594; &#8469;) &#8594; t &#8594; &#119878; a</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- prefixBeforeN&#119878; n&#8320; p (stream &#8594; &#119878; s&#8320; g) </span><span>
</span><span id="line-219"></span><span class="hs-comment">--   | n&#8320; &#8801; 0 = empty&#119878;</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   | otherwise = &#119878; (0 :* s&#8320;) $ \ (n :* s) &#8594; do</span><span>
</span><span id="line-221"></span><span class="hs-comment">--       (x :* s') &#8592; g s</span><span>
</span><span id="line-222"></span><span class="hs-comment">--       let n' = n + p x</span><span>
</span><span id="line-223"></span><span class="hs-comment">--       case n' &#8805; n&#8320; of</span><span>
</span><span id="line-224"></span><span class="hs-comment">--         True &#8594; None </span><span>
</span><span id="line-225"></span><span class="hs-comment">--         False &#8594; return (x :* (n' :* s'))</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- </span><span>
</span><span id="line-227"></span><span class="hs-comment">-- postfixAfter&#119878; &#8759; (ToStream a t) &#8658; (a &#8594; &#120121;) &#8594; t &#8594; &#119878; a</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- postfixAfter&#119878; p (stream &#8594; &#119878; s&#8320; g) = ifNone empty&#119878; $ loop s&#8320;</span><span>
</span><span id="line-229"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-230"></span><span class="hs-comment">--     loop s = do</span><span>
</span><span id="line-231"></span><span class="hs-comment">--       (x :* s') &#8592; g s</span><span>
</span><span id="line-232"></span><span class="hs-comment">--       case p x of</span><span>
</span><span id="line-233"></span><span class="hs-comment">--         True &#8594; Some (&#119878; s' g) </span><span>
</span><span id="line-234"></span><span class="hs-comment">--         False &#8594; loop s'</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- </span><span>
</span><span id="line-236"></span><span class="hs-comment">-- inbetween&#119878; &#8759; (ToStream a t) &#8658; a &#8594; t &#8594; &#119878; a</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- inbetween&#119878; i (stream &#8594; &#119878; s&#8320; g) = &#119878; (s&#8320; :* None) $ \ (s :* xMM) &#8594; do</span><span>
</span><span id="line-238"></span><span class="hs-comment">--   case xMM of</span><span>
</span><span id="line-239"></span><span class="hs-comment">--     None &#8594; do</span><span>
</span><span id="line-240"></span><span class="hs-comment">--       x :* s' &#8592; g s</span><span>
</span><span id="line-241"></span><span class="hs-comment">--       return $ x :* (s' :* Some None)</span><span>
</span><span id="line-242"></span><span class="hs-comment">--     Some None &#8594; do</span><span>
</span><span id="line-243"></span><span class="hs-comment">--       x :* s' &#8592; g s</span><span>
</span><span id="line-244"></span><span class="hs-comment">--       return $ i :* (s' :* Some (Some x))</span><span>
</span><span id="line-245"></span><span class="hs-comment">--     Some (Some x) &#8594; do</span><span>
</span><span id="line-246"></span><span class="hs-comment">--       return $ x :* (s :* Some None)</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- </span><span>
</span><span id="line-248"></span><span class="hs-comment">-- coredata_stream_e1 &#8759; &#119878; &#8469;</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- coredata_stream_e1 = stream [1,2,3,4,5,4,3,2,1]</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- </span><span>
</span><span id="line-251"></span><span class="hs-comment">-- filter&#119878; &#8759; (ToStream a t) &#8658; (a &#8594; &#120121;) &#8594; t &#8594; &#119878; a</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- filter&#119878; f (stream &#8594; &#119878; s&#8320; g) = &#119878; s&#8320; loop</span><span>
</span><span id="line-253"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-254"></span><span class="hs-comment">--     loop s = do</span><span>
</span><span id="line-255"></span><span class="hs-comment">--       (x :* s') &#8592; g s</span><span>
</span><span id="line-256"></span><span class="hs-comment">--       if f x </span><span>
</span><span id="line-257"></span><span class="hs-comment">--          then Some $ x :* s'</span><span>
</span><span id="line-258"></span><span class="hs-comment">--          else loop s'</span><span>
</span><span id="line-259"></span></pre></body></html>