module UVMHS.Lib.Substitution.Var where

import UVMHS.Core
import UVMHS.Lib.Pretty
import UVMHS.Lib.Parser
import UVMHS.Lib.Rand

----------------------
-- SIMPLE VARIABLES --
----------------------

-- simple variables
data ğ• = ğ•
  { ğ•©mark âˆ· ğ‘‚ â„•64
  , ğ•©name âˆ· ğ•Š
  } deriving (Eq,Ord,Show)
makeLenses ''ğ•

var âˆ· ğ•Š â†’ ğ•
var = ğ• None

cpVar âˆ· CParser TokenBasic ğ•
cpVar = var ^$ cpShaped $ view nameTBasicL

cpVarWS âˆ· CParser TokenWSBasic ğ•
cpVarWS = var ^$ cpShaped $ view nameTWSBasicL

instance Pretty ğ• where
  pretty (ğ• nO x) = concat
    [ ppString x
    , elimğ‘‚ null (\ n â†’ ppPun $ concat ["#",showğ•Š n]) nO
    ]

instance Fuzzy ğ• where
  fuzzy = do
    nO â† fuzzy
    return $ ğ• nO "x"

ppDVar âˆ· â„•64 â†’ Doc
ppDVar n = concat [ppPun "âŒŠ",pretty n,ppPun "âŒ‹"]

